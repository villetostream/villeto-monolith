{
	# Global options
	email villetosystems@gmail.com
}

api.villeto.com {
	# Compression
	encode zstd gzip

	# Proxy everything to the upstream service on Docker network 'web'
	reverse_proxy api-gateway-blue:3000 {
		# Preserve original host and forwarding headers for your app
		header_up Host {http.request.host}
		header_up X-Real-IP {http.request.remote}
		header_up X-Forwarded-For {http.request.remote}
		header_up X-Forwarded-Proto {http.request.scheme}
		header_up X-Forwarded-Host {http.request.host}
		header_up X-Forwarded-Server {env.HOSTNAME}
	}

	# Logging (rotated)
	log {
		output file /data/local-access.log {
			roll_size 5mb
			roll_keep 5
			roll_keep_for 720h
		}
		format json
	}
}
